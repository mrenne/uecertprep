import React, { useState, useEffect } from 'react';
import { Play, Menu, X, ChevronRight, BookOpen, Layers, Zap, Box, Film, Music, Cpu, Layout, Monitor } from 'lucide-react';

// Data for the tutorial sections
const sections = [
  {
    id: 'editor-navigation',
    title: 'Editor Navigation',
    icon: <Monitor size={20} />,
    description: 'Master the viewport, content browser, and details panel. Learn the essential shortcuts to navigate the 3D space with speed and precision.',
    duration: '12:30'
  },
  {
    id: 'file-management',
    title: 'File Management',
    icon: <Layers size={20} />,
    description: 'Best practices for organizing your project folder structure, naming conventions, and managing assets to keep your project scalable and clean.',
    duration: '08:45'
  },
  {
    id: 'blueprint-scripting',
    title: 'Blueprint Scripting',
    icon: <Cpu size={20} />,
    description: 'Introduction to visual scripting. Understand nodes, variables, functions, and flow control to create interactive gameplay mechanics without writing code.',
    duration: '25:15'
  },
  {
    id: 'materials',
    title: 'Materials',
    icon: <Box size={20} />,
    description: 'Create physically based materials. Learn about textures, shaders, material instances, and the material graph to give surfaces realistic detail.',
    duration: '18:20'
  },
  {
    id: 'lighting',
    title: 'Lighting',
    icon: <Zap size={20} />,
    description: 'Explore static, stationary, and dynamic lighting. Master Lumen, light baking, and post-processing volumes to set the perfect mood.',
    duration: '22:10'
  },
  {
    id: 'world-building',
    title: 'World Building',
    icon: <BookOpen size={20} />,
    description: 'Use Landscape tools and Foliage mode to sculpt terrains and populate environments. Learn about level streaming and world partition.',
    duration: '30:00'
  },
  {
    id: 'sequencer',
    title: 'Sequencer',
    icon: <Film size={20} />,
    description: 'Create cinematic cutscenes and linear animations. Learn keyframing, camera cuts, and rendering movies using the Sequencer tool.',
    duration: '15:50'
  },
  {
    id: 'metasounds',
    title: 'MetaSounds',
    icon: <Music size={20} />,
    description: 'Next-generation audio. Build complex procedural audio systems and interactive soundscapes directly within the engine.',
    duration: '14:25'
  },
  {
    id: 'niagara-vfx',
    title: 'Niagara Visual Effects',
    icon: <Zap size={20} />, // Reusing Zap or similar, maybe wind/sparkles if available, Zap fits energy
    description: 'Design particle systems for fire, smoke, and magic. Understand emitters, systems, and modules to create stunning visual effects.',
    duration: '20:40'
  },
  {
    id: 'umg-ui',
    title: 'UMG UI',
    icon: <Layout size={20} />,
    description: 'Build user interfaces with Unreal Motion Graphics (UMG). Create menus, HUDs, and interactive widgets for your game.',
    duration: '16:30'
  },
];

const VideoPlaceholder = ({ title, duration }) => {
  const [isPlaying, setIsPlaying] = useState(false);

  return (
    <div className="w-full aspect-video bg-slate-900 rounded-lg overflow-hidden border border-slate-700 shadow-lg relative group">
      {!isPlaying ? (
        <div className="absolute inset-0 flex flex-col items-center justify-center bg-slate-800/50 group-hover:bg-slate-800/40 transition-colors cursor-pointer" onClick={() => setIsPlaying(true)}>
            {/* Thumbnail Mockup */}
            <div className="absolute inset-0 bg-gradient-to-tr from-slate-900 to-slate-800 opacity-90 z-0"></div>
            
            {/* Play Button */}
            <div className="z-10 w-16 h-16 bg-blue-600 rounded-full flex items-center justify-center shadow-xl group-hover:scale-110 transition-transform duration-300">
              <Play className="text-white ml-1" size={32} fill="currentColor" />
            </div>
            
            <p className="z-10 mt-4 text-slate-300 font-medium tracking-wide">Watch Tutorial</p>
            <span className="z-10 mt-2 text-xs bg-black/60 px-2 py-1 rounded text-slate-400 font-mono">{duration}</span>
        </div>
      ) : (
        <div className="w-full h-full bg-black flex items-center justify-center relative">
          <p className="text-slate-500 animate-pulse">Loading YouTube Player...</p>
          <button 
            onClick={(e) => { e.stopPropagation(); setIsPlaying(false); }}
            className="absolute top-4 right-4 text-slate-500 hover:text-white"
          >
            <X size={24} />
          </button>
          {/* In a real app, the iframe would go here:
          <iframe 
            width="100%" 
            height="100%" 
            src={`https://www.youtube.com/embed/${videoId}?autoplay=1`} 
            title={title} 
            frameBorder="0" 
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
            allowFullScreen
          ></iframe> 
          */}
        </div>
      )}
    </div>
  );
};

export default function App() {
  const [activeSection, setActiveSection] = useState(sections[0].id);
  const [isMobileMenuOpen, setIsMobileMenuOpen] = useState(false);

  // Smooth scroll handler
  const scrollToSection = (id) => {
    const element = document.getElementById(id);
    if (element) {
      element.scrollIntoView({ behavior: 'smooth' });
      setActiveSection(id);
      setIsMobileMenuOpen(false);
    }
  };

  // Update active section on scroll
  useEffect(() => {
    const handleScroll = () => {
      const scrollPosition = window.scrollY + 100; // Offset for header
      
      for (const section of sections) {
        const element = document.getElementById(section.id);
        if (element && element.offsetTop <= scrollPosition && (element.offsetTop + element.offsetHeight) > scrollPosition) {
          setActiveSection(section.id);
        }
      }
    };

    window.addEventListener('scroll', handleScroll);
    return () => window.removeEventListener('scroll', handleScroll);
  }, []);

  return (
    <div className="min-h-screen bg-slate-950 text-slate-200 font-sans selection:bg-blue-500/30">
      
      {/* Mobile Header */}
      <div className="lg:hidden fixed top-0 left-0 right-0 h-16 bg-slate-900/90 backdrop-blur-md border-b border-slate-800 z-50 flex items-center justify-between px-4">
        <div className="font-bold text-lg tracking-tight text-white flex items-center gap-2">
          <div className="w-8 h-8 bg-blue-600 rounded-md flex items-center justify-center font-bold text-xl">U</div>
          UE Fundamentals
        </div>
        <button onClick={() => setIsMobileMenuOpen(!isMobileMenuOpen)} className="p-2 text-slate-400 hover:text-white">
          {isMobileMenuOpen ? <X size={24} /> : <Menu size={24} />}
        </button>
      </div>

      {/* Mobile Navigation Menu */}
      {isMobileMenuOpen && (
        <div className="fixed inset-0 top-16 bg-slate-950 z-40 lg:hidden overflow-y-auto pb-8">
          <nav className="p-4 space-y-1">
            {sections.map((section) => (
              <button
                key={section.id}
                onClick={() => scrollToSection(section.id)}
                className={`w-full text-left px-4 py-3 rounded-lg flex items-center gap-3 transition-colors ${
                  activeSection === section.id 
                    ? 'bg-blue-600/10 text-blue-400 border border-blue-600/20' 
                    : 'text-slate-400 hover:bg-slate-900 hover:text-slate-200'
                }`}
              >
                {section.icon}
                <span className="font-medium">{section.title}</span>
              </button>
            ))}
          </nav>
        </div>
      )}

      <div className="flex max-w-7xl mx-auto pt-16 lg:pt-0">
        
        {/* Desktop Sidebar Navigation */}
        <aside className="hidden lg:block w-72 fixed h-screen top-0 left-auto border-r border-slate-800 overflow-y-auto bg-slate-950 z-10 scrollbar-hide">
          <div className="p-8 pb-4">
            <div className="flex items-center gap-3 mb-2">
               <div className="w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center font-bold text-2xl text-white shadow-lg shadow-blue-900/20">U</div>
               <div>
                 <h1 className="font-bold text-xl text-white tracking-tight leading-none">UE Fundamentals</h1>
                 <p className="text-xs text-slate-500 font-medium mt-1">Certification Prep</p>
               </div>
            </div>
          </div>
          
          <nav className="px-4 py-2 space-y-1">
            {sections.map((section) => (
              <button
                key={section.id}
                onClick={() => scrollToSection(section.id)}
                className={`w-full group flex items-center justify-between px-4 py-3 rounded-lg text-sm font-medium transition-all duration-200 ${
                  activeSection === section.id
                    ? 'bg-blue-600 text-white shadow-md shadow-blue-900/20'
                    : 'text-slate-400 hover:bg-slate-900 hover:text-slate-200'
                }`}
              >
                <div className="flex items-center gap-3">
                  <span className={`${activeSection === section.id ? 'text-blue-200' : 'text-slate-500 group-hover:text-slate-400'}`}>
                    {section.icon}
                  </span>
                  {section.title}
                </div>
                {activeSection === section.id && <ChevronRight size={14} className="opacity-75" />}
              </button>
            ))}
          </nav>

          <div className="px-8 mt-8 pb-8">
            <div className="bg-slate-900 p-4 rounded-xl border border-slate-800">
                <h4 className="text-xs font-semibold text-slate-400 uppercase tracking-wider mb-2">Progress</h4>
                <div className="w-full h-1.5 bg-slate-800 rounded-full overflow-hidden">
                    <div className="h-full bg-blue-600 w-1/3 rounded-full"></div>
                </div>
                <p className="text-xs text-slate-500 mt-2">3 of 10 Modules Complete</p>
            </div>
          </div>
        </aside>

        {/* Main Content */}
        <main className="flex-1 lg:ml-72 min-h-screen">
            {/* Hero / Intro Area */}
            <div className="px-6 py-12 lg:px-12 lg:py-16 border-b border-slate-800 bg-slate-900/30">
                <div className="max-w-3xl">
                    <h2 className="text-3xl lg:text-4xl font-bold text-white mb-4">Unreal Engine 3D Fundamentals</h2>
                    <p className="text-lg text-slate-400 leading-relaxed">
                        A comprehensive video series designed to prepare students and teachers for the official certification. 
                        Follow along with the modules below to master the core concepts of the engine.
                    </p>
                </div>
            </div>

            {/* Tutorial Feed */}
            <div className="px-6 py-8 lg:px-12 lg:py-12 space-y-16 lg:space-y-24">
                {sections.map((section, index) => (
                <div key={section.id} id={section.id} className="scroll-mt-24 lg:scroll-mt-8">
                    <div className="flex items-baseline gap-4 mb-4">
                        <span className="text-sm font-mono text-blue-500 font-bold">0{index + 1}</span>
                        <h3 className="text-2xl font-semibold text-slate-100">{section.title}</h3>
                    </div>
                    
                    <div className="grid grid-cols-1 lg:grid-cols-5 gap-8">
                        {/* Video Column */}
                        <div className="lg:col-span-3">
                            <VideoPlaceholder title={section.title} duration={section.duration} />
                        </div>

                        {/* Text Column */}
                        <div className="lg:col-span-2 flex flex-col justify-center">
                            <div className="bg-slate-900/50 rounded-xl p-6 border border-slate-800/50 hover:border-slate-700 transition-colors">
                                <h4 className="text-sm font-semibold text-slate-300 uppercase tracking-wider mb-3 flex items-center gap-2">
                                    <BookOpen size={14} className="text-blue-500"/>
                                    Overview
                                </h4>
                                <p className="text-slate-400 leading-relaxed text-sm lg:text-base">
                                    {section.description}
                                </p>
                                
                                <div className="mt-6 pt-6 border-t border-slate-800 flex items-center gap-4">
                                    <button className="text-xs font-semibold text-blue-400 hover:text-blue-300 uppercase tracking-wide flex items-center gap-1 transition-colors">
                                        Resources <ChevronRight size={12}/>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                ))}
            </div>

            <footer className="mt-20 py-12 border-t border-slate-800 text-center text-slate-500 text-sm">
                <p>&copy; {new Date().getFullYear()} UE Fundamentals Certification Prep.</p>
                <p className="mt-2">Not affiliated with Epic Games.</p>
            </footer>
        </main>
      </div>
    </div>
  );
}
